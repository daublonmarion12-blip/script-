-- Commande de chargement (Loading Stream)
-- loadstring(game:HttpGet("https://raw.githubusercontent.com/daublonmarion12-blip/script-/main/MM2"))()

local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()

local Window = Fluent:CreateWindow({
    Title = "MM2 XENO FIX",
    SubTitle = "A = Gauche | ESP Wallhack",
    TabWidth = 160,
    Size = UDim2.fromOffset(580, 460),
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.LeftControl
})

local Tabs = { 
    Main = Window:AddTab({ Title = "Visuals", Icon = "eye" }),
    Farm = Window:AddTab({ Title = "Farming", Icon = "coins" }),
    Move = Window:AddTab({ Title = "Mouvement", Icon = "run" })
}

local lp = game.Players.LocalPlayer
local UIS = game:GetService("UserInputService")
local TS = game:GetService("TweenService")

-- 1. ESP WALLHACK (BILLBOARD - TOUJOURS VISIBLE)
local EspToggle = Tabs.Main:AddToggle("RoleESP", {Title = "ESP Wallhack", Default = false})
local function CreateESP(player)
    if player == lp then return end
    local function apply()
        local char = player.Character or player.CharacterAdded:Wait()
        local hrp = char:WaitForChild("HumanoidRootPart", 10)
        local b = Instance.new("BillboardGui", hrp)
        b.Name = "ESP_Fix"
        b.AlwaysOnTop = true
        b.Size = UDim2.new(4, 0, 5.5, 0)
        local f = Instance.new("Frame", b)
        f.Size = UDim2.new(1, 0, 1, 0)
        f.BackgroundTransparency = 0.5
        task.spawn(function()
            while b and b.Parent do
                if not EspToggle.Value then b:Destroy() break end
                if player.Backpack:FindFirstChild("Knife") or char:FindFirstChild("Knife") then f.BackgroundColor3 = Color3.new(1,0,0)
                elseif player.Backpack:FindFirstChild("Gun") or char:FindFirstChild("Gun") then f.BackgroundColor3 = Color3.new(0,0,1)
                else f.BackgroundColor3 = Color3.new(0,1,0) end
                task.wait(1)
            end
        end)
    end
    apply()
    player.CharacterAdded:Connect(apply)
end
EspToggle:OnChanged(function() if EspToggle.Value then for _, p in pairs(game.Players:GetPlayers()) do CreateESP(p) end end end)

-- 2. FLY (A = GAUCHE)
local Flying = false
local FlyToggle = Tabs.Move:AddToggle("FlyToggle", {Title = "Fly (A pour Gauche)", Default = false})
task.spawn(function()
    while true do
        task.wait()
        if Flying and lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") then
            local root = lp.Character.HumanoidRootPart
            local cam = workspace.CurrentCamera.CFrame
            local dir = Vector3.new(0,0,0)
            for _, p in pairs(lp.Character:GetDescendants()) do if p:IsA("BasePart") then p.CanCollide = false end end
            if UIS:IsKeyDown(Enum.KeyCode.W) then dir = dir + cam.LookVector end
            if UIS:IsKeyDown(Enum.KeyCode.S) then dir = dir - cam.LookVector end
            if UIS:IsKeyDown(Enum.KeyCode.A) then dir = dir - cam.RightVector end -- GAUCHE
            if UIS:IsKeyDown(Enum.KeyCode.D) then dir = dir + cam.RightVector end
            if UIS:IsKeyDown(Enum.KeyCode.Space) then dir = dir + Vector3.new(0,1,0) end
            if UIS:IsKeyDown(Enum.KeyCode.LeftShift) then dir = dir - Vector3.new(0,1,0) end
            root.Velocity = dir * 50
            local bg = root:FindFirstChild("FlyGyro") or Instance.new("BodyGyro", root)
            bg.maxTorque = Vector3.new(9e9,9e9,9e9); bg.cframe = cam
        end
    end
end)
FlyToggle:OnChanged(function() Flying = FlyToggle.Value end)

-- 3. COIN FARM (GLISSADE)
local FarmToggle = Tabs.Farm:AddToggle("AutoFarm", {Title = "Activer Coin Farm", Default = false})
task.spawn(function()
    while true do
        task.wait(0.2)
        if FarmToggle.Value and lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") then
            for _, v in pairs(workspace:GetDescendants()) do
                if not FarmToggle.Value then break end
                if (v.Name == "CoinVisual" or v.Name == "Coin") and v:IsA("BasePart") then
                    local dist = (lp.Character.HumanoidRootPart.Position - v.Position).Magnitude
                    if dist < 600 then
                        local t = TS:Create(lp.Character.HumanoidRootPart, TweenInfo.new(dist/20, Enum.EasingStyle.Linear), {CFrame = v.CFrame})
                        t:Play()
                        t.Completed:Wait()
                    end
                end
            end
        end
    end
end)
